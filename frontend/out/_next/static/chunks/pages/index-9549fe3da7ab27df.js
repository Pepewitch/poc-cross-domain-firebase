(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return c(7744)}])},7744:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return t}});var d,e=c(7568),f=c(4051),g=c.n(f),h=c(5893),i=c(9669),j=c.n(i),k=c(7702),l=c(7294),m=c(5503),n=(0,m.ZF)({apiKey:"AIzaSyDWce4Catb6RvxNoM7OqlBYokQutnhSH4o",authDomain:"poc-cross-domain-firebase.firebaseapp.com",projectId:"poc-cross-domain-firebase",storageBucket:"poc-cross-domain-firebase.appspot.com",messagingSenderId:"485336828550",appId:"1:485336828550:web:758171cf2394888d4c9f07",measurementId:"G-BQB27Z7QHL"}),o=(0,k.v0)(n),p="https://poc-cross-domain-firebase-api.anypoc.app";j().defaults.withCredentials=!0;var q=(d=(0,e.Z)(g().mark(function a(b){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,j().post("".concat(p,"/sign-in"),{idToken:b});case 2:case"end":return a.stop()}},a)})),function(a){return d.apply(this,arguments)}),r=function(){var a,b=(0,l.useState)(""),c=b[0],d=b[1],f=(0,l.useState)(""),i=f[0],j=f[1],m=(0,l.useState)(!1),n=m[0],p=m[1],r=(a=(0,e.Z)(g().mark(function a(){var b;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return p(!0),a.prev=1,a.next=4,(0,k.Xb)(o,c,i);case 4:return b=a.sent,a.t0=q,a.next=8,b.user.getIdToken();case 8:return a.t1=a.sent,a.next=11,(0,a.t0)(a.t1);case 11:d(""),j(""),a.next=18;break;case 15:a.prev=15,a.t2=a.catch(1),alert(a.t2.message);case 18:return a.prev=18,p(!1),a.finish(18);case 21:case"end":return a.stop()}},a,null,[[1,15,18,21]])})),function(){return a.apply(this,arguments)});return(0,h.jsxs)("form",{className:"flex p-2 flex-col",onSubmit:function(a){a.preventDefault(),r()},children:[(0,h.jsx)("h1",{className:"mb-2 font-bold",children:"Register new user"}),(0,h.jsx)("input",{className:"p-1 border mb-2 rounded-md",disabled:n,value:c,placeholder:"Email",onChange:function(a){return d(a.target.value)}}),(0,h.jsx)("input",{className:"p-1 border mb-2 rounded-md",disabled:n,value:i,type:"password",placeholder:"Password",onChange:function(a){return j(a.target.value)}}),(0,h.jsx)("button",{disabled:n,type:"submit",className:"p-1 border text-white bg-blue-700 rounded-md",children:n?"Registering...":"Register"})]})},s=function(){var a,b=(0,l.useState)(""),c=b[0],d=b[1],f=(0,l.useState)(""),i=f[0],j=f[1],m=(0,l.useState)(!1),n=m[0],p=m[1],r=(a=(0,e.Z)(g().mark(function a(){var b;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return p(!0),a.prev=1,a.next=4,(0,k.e5)(o,c,i);case 4:return b=a.sent,a.t0=q,a.next=8,b.user.getIdToken();case 8:return a.t1=a.sent,a.next=11,(0,a.t0)(a.t1);case 11:d(""),j(""),a.next=18;break;case 15:a.prev=15,a.t2=a.catch(1),alert(a.t2.message);case 18:return a.prev=18,p(!1),a.finish(18);case 21:case"end":return a.stop()}},a,null,[[1,15,18,21]])})),function(){return a.apply(this,arguments)});return(0,h.jsxs)("form",{className:"flex p-2 flex-col",onSubmit:function(a){a.preventDefault(),r()},children:[(0,h.jsx)("h1",{className:"mb-2 font-bold",children:"Sign in"}),(0,h.jsx)("input",{className:"p-1 border mb-2 rounded-md",disabled:n,value:c,placeholder:"Email",onChange:function(a){return d(a.target.value)}}),(0,h.jsx)("input",{className:"p-1 border mb-2 rounded-md",disabled:n,value:i,type:"password",placeholder:"Password",onChange:function(a){return j(a.target.value)}}),(0,h.jsx)("button",{disabled:n,type:"submit",className:"p-1 border text-white bg-blue-700 rounded-md",children:n?"Signing in...":"Sign in"})]})};function t(){var a,b=(0,l.useState)(null),c=b[0],d=b[1],f=(0,l.useState)(!0),i=f[0],m=f[1];(0,l.useEffect)(function(){o.onAuthStateChanged(function(a){d(a)})},[]),(0,l.useEffect)(function(){var a;(a=(0,e.Z)(g().mark(function a(){var b;return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,m(!0),a.next=4,j().get("".concat(p,"/sync"));case 4:if(!(b=a.sent.data).customToken){a.next=8;break}return a.next=8,(0,k._p)(o,b.customToken);case 8:a.next=15;break;case 10:return a.prev=10,a.t0=a.catch(0),a.next=14,o.signOut();case 14:console.error(a.t0);case 15:return a.prev=15,m(!1),a.finish(15);case 18:case"end":return a.stop()}},a,null,[[0,10,15,18]])})),function(){return a.apply(this,arguments)})()},[]);var n=(a=(0,e.Z)(g().mark(function a(){return g().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=j(),a.t1="".concat(p,"/sign-out"),a.next=4,c.getIdToken();case 4:return a.t2=a.sent,a.t3={idToken:a.t2},a.next=8,a.t0.post.call(a.t0,a.t1,a.t3);case 8:o.signOut();case 9:case"end":return a.stop()}},a)})),function(){return a.apply(this,arguments)});return(0,h.jsxs)("div",{className:"flex p-2 flex-col items-center max-w-4xl mx-auto",children:[(0,h.jsx)("h1",{className:"text-3xl font-bold underline mb-6",children:"PoC Cross domain Firebase!"}),(0,h.jsxs)("div",{className:"mb-6",children:[(0,h.jsxs)("h2",{children:["First domain:"," ",(0,h.jsx)("a",{className:"underline text-blue-700",target:"_blank",rel:"noreferrer",href:"https://poc-cross-domain-firebase.anypoc.app",children:"https://poc-cross-domain-firebase.anypoc.app"})]}),(0,h.jsxs)("h2",{children:["Second domain:"," ",(0,h.jsx)("a",{className:"underline text-blue-700",target:"_blank",rel:"noreferrer",href:"https://poc-cross-domain-firebase2.anypoc.app",children:"https://poc-cross-domain-firebase2.anypoc.app"})]})]}),(0,h.jsx)("p",{className:"mb-4 text-xl",children:i?(0,h.jsx)(h.Fragment,{children:"Loading..."}):c?(0,h.jsxs)(h.Fragment,{children:["You logged in with"," ",(0,h.jsx)("span",{className:"text-red-700 font-bold underline",children:c.email})]}):"You have not logged in"}),!!c&&(0,h.jsx)("button",{className:"bg-red-700 text-white rounded-md p-2 w-48 mb-6",onClick:n,children:"Logout"}),!i&&!c&&(0,h.jsxs)("div",{className:"grid w-full grid-cols-2",children:[(0,h.jsx)("div",{children:(0,h.jsx)(r,{})}),(0,h.jsx)("div",{children:(0,h.jsx)(s,{})})]})]})}}},function(a){a.O(0,[440,233,774,888,179],function(){var b;return a(a.s=8312)}),_N_E=a.O()}])